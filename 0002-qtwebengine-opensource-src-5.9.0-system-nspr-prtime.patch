From 1592ad223b8fe064a72e21e54d36de4bc9949756 Mon Sep 17 00:00:00 2001
From: Helio Chissini de Castro <helio@kde.org>
Date: Wed, 31 May 2017 10:46:36 +0200
Subject: [PATCH] qtwebengine-opensource-src-5.9.0-system-nspr-prtime

---
 src/3rdparty/chromium/base/BUILD.gn                   | 2 --
 src/3rdparty/chromium/base/time/pr_time_unittest.cc   | 2 +-
 src/3rdparty/chromium/base/time/time.cc               | 2 +-
 src/3rdparty/chromium/tools/gn/bootstrap/bootstrap.py | 4 ++++
 4 files changed, 6 insertions(+), 4 deletions(-)

diff --git a/src/3rdparty/chromium/base/BUILD.gn b/src/3rdparty/chromium/base/BUILD.gn
index f2672cba7..66f2be1ff 100644
--- a/src/3rdparty/chromium/base/BUILD.gn
+++ b/src/3rdparty/chromium/base/BUILD.gn
@@ -833,8 +833,6 @@ component("base") {
     "third_party/dmg_fp/g_fmt.cc",
     "third_party/icu/icu_utf.cc",
     "third_party/icu/icu_utf.h",
-    "third_party/nspr/prtime.cc",
-    "third_party/nspr/prtime.h",
     "third_party/superfasthash/superfasthash.c",
     "threading/non_thread_safe.h",
     "threading/non_thread_safe_impl.cc",
diff --git a/src/3rdparty/chromium/base/time/pr_time_unittest.cc b/src/3rdparty/chromium/base/time/pr_time_unittest.cc
index 3f1a348ae..8f1a11e51 100644
--- a/src/3rdparty/chromium/base/time/pr_time_unittest.cc
+++ b/src/3rdparty/chromium/base/time/pr_time_unittest.cc
@@ -7,7 +7,7 @@
 
 #include "base/compiler_specific.h"
 #include "base/macros.h"
-#include "base/third_party/nspr/prtime.h"
+#include <nspr4/prtime.h>
 #include "base/time/time.h"
 #include "build/build_config.h"
 #include "testing/gtest/include/gtest/gtest.h"
diff --git a/src/3rdparty/chromium/base/time/time.cc b/src/3rdparty/chromium/base/time/time.cc
index 4e942015f..29fde71dd 100644
--- a/src/3rdparty/chromium/base/time/time.cc
+++ b/src/3rdparty/chromium/base/time/time.cc
@@ -13,8 +13,8 @@
 #include "base/lazy_instance.h"
 #include "base/logging.h"
 #include "base/macros.h"
+#include <nspr4/prtime.h>
 #include "base/strings/stringprintf.h"
-#include "base/third_party/nspr/prtime.h"
 #include "build/build_config.h"
 
 namespace base {
diff --git a/src/3rdparty/chromium/tools/gn/bootstrap/bootstrap.py b/src/3rdparty/chromium/tools/gn/bootstrap/bootstrap.py
index 43d252b43..fc7efd80a 100755
--- a/src/3rdparty/chromium/tools/gn/bootstrap/bootstrap.py
+++ b/src/3rdparty/chromium/tools/gn/bootstrap/bootstrap.py
@@ -576,6 +576,10 @@ def write_gn_ninja(path, root_gen_dir, options):
 
   if is_linux:
     libs.extend(['-lrt'])
+    libs.extend(['-lplds4'])
+    libs.extend(['-lplc4'])
+    libs.extend(['-lnspr4'])
+
     ldflags.extend(['-pthread'])
 
     static_libraries['xdg_user_dirs'] = {
-- 
2.13.0

